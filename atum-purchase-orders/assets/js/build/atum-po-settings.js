(()=>{"use strict";var t,e={1669:t=>{t.exports=jQuery}},n={};function i(t){var a=n[t];if(void 0!==a)return a.exports;var o=n[t]={exports:{}};return e[t](o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),function(t){t.success="#69C61D",t.primary="#00B8DB",t.warning="#EFAF00",t.danger="#FF4848",t.grey="#ADB5BD"}(t||(t={}));const a=Swal;var o=i.n(a),r=function(){return r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},r.apply(this,arguments)};const s=function(e,n,i){void 0===n&&(n={}),void 0===i&&(i=null);var a=this;this.settings=e,this.swalOptions=n,this.closeCallback=i;var s={icon:"question",title:this.settings.get("areYouSure"),text:this.settings.get("cannotBeUndone"),confirmButtonText:this.settings.get("removeIt"),confirmButtonColor:t.danger,showCancelButton:!0,showCloseButton:!0,cancelButtonText:this.settings.get("cancel"),reverseButtons:!0};n.preConfirm&&!n.showLoaderOnConfirm&&(n.showLoaderOnConfirm=!0),n=n?r(r({},s),n):s,o().fire(n).then((function(t){a.closeCallback&&a.closeCallback(t)}))};var u=i(1669);const p=function(){function t(t){this.settings=t,this.$atumSettingsWrapper=u(".atum-settings-wrapper"),this.$numberPattern=null,this.$poCounter=null,this.$paddingZeros=null,this.wpHooks=window.wp.hooks,this.bindEvents(),this.addHooks(),u("#atum_po_numbering_custom_pattern").length&&this.addCutomPONumberPreviewer()}return t.prototype.bindEvents=function(){var t=this;this.$atumSettingsWrapper.on("change","#atum_po_required_requisition",(function(e){return t.handleRequisitionerChange(u(e.currentTarget))})).on("click","#atum_po_preview_email_template",(function(){return t.previewEmailTemplate()})).on("click","#atum_po_preview_pdf_template",(function(){return t.previewPDFTemplate()}))},t.prototype.addHooks=function(){var t=this;this.wpHooks.addAction("atum_settingsPage_moveToTab","atum",(function(e){"purchase_orders"===e.data("tab")&&t.addCutomPONumberPreviewer()}))},t.prototype.handleRequisitionerChange=function(t){var e=this;t.is(":checked")||new s(this.settings,{icon:"warning",text:this.settings.get("requisitionerDisableMsg"),confirmButtonText:this.settings.get("doIt"),allowEnterKey:!1,preConfirm:function(){return new Promise((function(t){u.ajax({url:window.ajaxurl,method:"post",dataType:"json",data:{action:"atum_po_convert_requisitioner_statuses",security:e.settings.get("nonce")},success:function(e){e.success||o().showValidationMessage(e.data),t()},error:function(){return t()}})}))}},(function(e){e.isConfirmed||t.prop("checked",!0)}))},t.prototype.addCutomPONumberPreviewer=function(){var t=this;this.$numberPattern=u("#atum_po_numbering_custom_pattern"),this.$poCounter=u("#atum_po_numbering_custom_counter"),this.$paddingZeros=u("#atum_po_numbering_custom_zeros"),this.$numberPattern.after('\n\t\t\t<blockquote id="po-number-previewer" style="margin-top: 7px; font-size: 12px;">\n\t\t\t\t'.concat(this.settings.get("nextPONumber"),': <strong class="next-po-number"></strong>\n\t\t\t</blockquote>\n\t\t')),this.$numberPattern.on("change",(function(){return t.updatePONumberPreview()})),this.updatePONumberPreview()},t.prototype.updatePONumberPreview=function(){var t=this,e=u("#po-number-previewer").find(".next-po-number"),n=this.$numberPattern.val()||"PO{counter}",i=this.$poCounter.val(),a=this.$paddingZeros.val();if(n.indexOf("{date:")>-1)u.ajax({url:window.ajaxurl,method:"post",dataType:"json",data:{security:this.settings.get("nonce"),action:"atum_po_preview_next_number",pattern:n,counter:i,padding_zeros:a},beforeSend:function(){return e.html(t.settings.get("loading"))},success:function(t){e.html(t.success?t.data:'<span class="error-message">'.concat(t.data,"</span>"))}});else{var o=n.replaceAll("{counter}",i.toString().padStart(a,"0"));o=o.replaceAll("{year}",(new Date).getFullYear().toString()),e.html(o)}},t.prototype.previewEmailTemplate=function(){var t=this.$atumSettingsWrapper.find("#atum_po_default_emails_template input[type=radio]").val(),e=this.$atumSettingsWrapper.find("#atum_po_default_emails_footer_ifr").contents().find("body").html().trim(),n=this.$atumSettingsWrapper.find("#atum_po_default_emails_template_color").val(),i=this.$atumSettingsWrapper.find("#atum_po_default_emails_template_logo input[type=hidden]").val(),a=this.$atumSettingsWrapper.find("#atum_po_default_emails_body_ifr").contents().find("body").html().trim();'<p><br data-mce-bogus="1"></p>'===a&&(a="");var o=u("<form>").attr("action",window.ajaxurl).attr("target","_blank").attr("method","post").css("display","none");o.html('\n\t\t\t<input type="hidden" name="action" value="atum_po_email_preview"/>\n\t\t\t<input type="hidden" name="nonce" value="'.concat(this.settings.get("poEmailPreviewNonce"),'"/>\n\t\t\t<input type="hidden" name="template" value="').concat(t,'"/>\n\t\t\t<input type="hidden" name="body" value="').concat(encodeURI(a),'"/>\n\t\t\t<input type="hidden" name="footer" value="').concat(encodeURI(e),'"/>\n\t\t\t<input type="hidden" name="color" value="').concat(n,'"/>\n\t\t\t<input type="hidden" name="logo" value="').concat(i,'"/>\n\t\t')).appendTo(u("body")),o.trigger("submit"),o.remove()},t.prototype.previewPDFTemplate=function(){var t=this.$atumSettingsWrapper.find("#atum_po_default_pdf_template input[type=radio]:checked").val(),e=this.$atumSettingsWrapper.find("#atum_po_default_pdf_template_color").val(),n=u("<form>").attr("action",window.ajaxurl).attr("target","_blank").attr("method","post").css("display","none");n.html('\n\t\t\t<input type="hidden" name="action" value="atum_po_pdf_preview"/>\n\t\t\t<input type="hidden" name="nonce" value="'.concat(this.settings.get("poPdfPreviewNonce"),'"/>\n\t\t\t<input type="hidden" name="template" value="').concat(t,'"/>\n\t\t\t<input type="hidden" name="color" value="').concat(e,'"/>\n\t\t')),this.$atumSettingsWrapper.find("#atum_setting_pdf_template .atum-settings-multi-checkbox input").each((function(t,e){var i=u(e);n.append('<input type="hidden" name="'.concat(i.attr("name"),'" value="').concat(i.val(),'"/>'))})),n.appendTo(u("body")),n.trigger("submit"),n.remove()},t}();const c=function(){function t(t,e){void 0===e&&(e={}),this.varName=t,this.defaults=e,this.settings={};var n=void 0!==window[t]?window[t]:{};Object.assign(this.settings,e,n)}return t.prototype.get=function(t){if(void 0!==this.settings[t])return this.settings[t]},t.prototype.getAll=function(){return this.settings},t.prototype.delete=function(t){this.settings.hasOwnProperty(t)&&delete this.settings[t]},t}();i(1669)((function(t){var e=new c("atumPOSettingsVars");new p(e)}))})();