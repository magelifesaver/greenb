!function(){"use strict";var e={n:function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,{a:s}),s},d:function(t,s){for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wc.blocksCheckout,s=window.React,n=window.wp.element,a=window.wp.i18n,i=window.wp.data,d=window.lodash,o=e.n(d);"undefined"!=typeof window?s.useLayoutEffect:s.useEffect;var r=window.wc.wcSettings,c=JSON.parse('{"apiVersion":2,"name":"szbd-shipping-message/szbd-shipping-map-block","version":"2.0.0","title":"Map and Plus Code Form","category":"woocommerce","description":"Adds a shipping map and a plus code form (Shipping Zones by Drawing)","supports":{"html":false,"align":false,"multiple":false,"reusable":false},"parent":["woocommerce/checkout-shipping-address-block"],"attributes":{"lock":{"type":"object","default":{"remove":true,"move":true}},"text":{"type":"string","default":""}},"textdomain":"szbd","editorStyle":"file:../../../build/style-szbd-shipping-map-block.css","style":"file:../../../build/style-index.css"}');(0,t.registerCheckoutBlock)({metadata:c,component:({checkoutExtensionData:e,extensions:c})=>{const{cartStore:l}=window.wc.wcBlocksData,{checkoutStore:p}=window.wc.wcBlocksData,{szbd_precise_address_mandatory:u,szbd_precise_address:m,szbd_precise_address_plus_code:b}=(0,r.getSetting)("szbd-shipping-map_data",""),{selectShippingRate:f,setIsCartDataStale:g,setCartData:w,setBillingAddress:h,setShippingAddress:_,shippingRatesBeingSelected:z}=(0,i.useDispatch)(l),{__internalIncrementCalculating:v,__internalDecrementCalculating:E}=(0,i.useDispatch)("wc/store/checkout"),{setExtensionData:k}=((0,n.useCallback)((0,d.debounce)(((e,s,n)=>{(0,t.extensionCartUpdate)(e,s,n)}),1e3),[t.extensionCartUpdate]),e),[S,y]=(0,n.useState)({}),[C,x]=(0,n.useState)(""),[D,N]=(0,n.useState)(""),{setValidationErrors:L,clearValidationError:P,showValidationError:U}=(0,i.useDispatch)("wc/store/validation"),A=(0,i.useSelect)((e=>e("wc/store/validation").getValidationError("szbd-no-picked-location"))),O=((0,i.useSelect)((e=>e(l).getHasCalculatedShipping())),(0,i.useSelect)((e=>e(l).getCustomerData()))),j=(0,i.useSelect)((e=>e(l).getNeedsShipping()));(0,i.useSelect)((e=>e(p).prefersCollection())),(0,i.useSelect)((e=>e(p).isCalculating()));const B=(0,i.useSelect)((e=>e(l).getCartData())),V=function(){const e=(0,s.useRef)(!1);return(0,s.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,s.useCallback)((()=>e.current),[])}();function I(e){return""!=e.shippingAddress.address_1}var R;(0,n.useEffect)((()=>{k("szbd","pluscode",C)}),[k,C]),(0,n.useEffect)((()=>{const e=()=>{if(V()){h({"szbd/shipping_point":""}),_({"szbd/shipping_point":""});let e=I(B);jQuery(document).trigger("szbd_map_loaded_blocks",[B,e])}};return window.addEventListener("load",e),window.addEventListener("szbd_map_loaded",e),(()=>{const e=o().isUndefined(B)||o().isNull(B)||o().isUndefined(B.extensions)||o().isUndefined(B.extensions["szbd-shipping-map"])?null:B.extensions["szbd-shipping-map"].shipping_point;if(!o().isNull(e)&&o().has(e,"fromUI"))return;let t=I(B);jQuery(document).trigger("szbd_map_update_blocks",[B,t,e])})(),()=>{window.removeEventListener("load",e),window.removeEventListener("szbd_map_loaded",e)}}),[B,V]),(0,n.useEffect)((()=>{const e=O.shippingAddress["szbd/shipping_point"];if(!function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(e))return;let t=JSON.parse(e);y(t)}),[O]),R=()=>{if(j){const e=new Event("szbd_map_loaded");window.dispatchEvent(e)}},(0,s.useEffect)(R,[]);{const e="yes"==u?(0,a.__)("Please Precise Your Shipping Location","szbd"):(0,a.__)("Precise Address?","szbd");return(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",{className:"szbd-shipping-details-block"},(0,s.createElement)("div",{id:"szbd_checkout_field",className:"at_fail"==m?" at_fail":""},"yes"==b?(0,s.createElement)("div",{className:"szbd-pluscode"},(0,s.createElement)(t.TextInput,{id:"szbd-plus-code",type:"text",required:!1,className:"szbd-plus-code-form",label:(0,a.__)("Find Location with Google Plus Code","szbd"),value:C,onChange:e=>{(e=>{if("updateserver"==e)x(""),(0,t.extensionCartUpdate)({namespace:"szbd-shipping-map-update",data:{lat:null,lng:null}});else{if("empty"==e)return void x("");x(e)}})(e)}})):"",A?.hidden?null:(0,s.createElement)("div",{className:"wc-block-components-validation-error",role:"alert"},(0,s.createElement)("p",null,A?.message)),(0,s.createElement)("div",{className:"wc-block-components-title szbd-map-title-block"},e),(0,s.createElement)("div",{id:"szbd-pick-content"},(0,s.createElement)("div",{className:"szbd-checkout-map"},(0,s.createElement)("div",{id:"szbd_map"}))))))}}})}();