(()=>{"use strict";var t={669:t=>{t.exports=jQuery}},e={};function n(s){var o=e[s];if(void 0!==o)return o.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);const s=function(){function t(t,e){void 0===e&&(e={}),this.varName=t,this.defaults=e,this.settings={};var n=void 0!==window[t]?window[t]:{};Object.assign(this.settings,e,n)}return t.prototype.get=function(t){if(void 0!==this.settings[t])return this.settings[t]},t.prototype.getAll=function(){return this.settings},t.prototype.delete=function(t){this.settings.hasOwnProperty(t)&&delete this.settings[t]},t}(),o=function(){var t,e={getClass:function(t){return Object.prototype.toString.call(t)},getType:function(t){if(null===t)return"null";switch(typeof t){case"number":return"number";case"string":return"string";case"boolean":return"boolean"}switch(e.getClass(t)){case"[object Array]":return"array";case"[object Object]":return"object"}throw new Error("Bad type: "+e.getClass(t))},forEachNode:function(t,n){var s;switch(e.getType(t)){case"array":s=t.length-1,t.forEach((function(t,e){n(e,t,e===s)}));break;case"object":var o=Object.keys(t).sort();s=o.length-1,o.forEach((function(e,o){n(e,t[e],o===s)}))}},inherits:(t=function(){},function(e,n){t.prototype=n.prototype,e.prototype=new t,e.prototype.constructor=e}),isValidRoot:function(t){switch(e.getType(t)){case"object":case"array":return!0;default:return!1}},extend:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}};function n(t,s,o){var r=e.getType(s);if(r in n.CONSTRUCTORS)return new n.CONSTRUCTORS[r](t,s,o);throw new Error("Bad type: "+e.getClass(s))}function s(t,e,n){if(this.constructor===s)throw new Error("This is abstract class");var o=this,r=document.createElement("li");o.label=t,o.isComplex=!1,r.classList.add("jsontree_node"),r.innerHTML=function(t,e){return'                    <span class="jsontree_label-wrapper">                        <span class="jsontree_label">"'+t+'"</span> : \t\t\t\t</span>\t\t\t\t<span class="jsontree_value-wrapper">\t\t\t\t\t<span class="jsontree_value jsontree_value_'+o.type+'">'+e+"</span>"+(n?"":",")+"</span>"}(t,e),o.el=r,r.querySelector(".jsontree_label").addEventListener("click",(function(t){t.altKey?o.toggleMarked():t.shiftKey&&(document.getSelection().removeAllRanges(),alert(o.getJSONPath()))}),!1)}function o(t,e,n){this.type="boolean",s.call(this,t,e,n)}function r(t,e,n){this.type="number",s.call(this,t,e,n)}function i(t,e,n){this.type="string",s.call(this,t,'"'+e+'"',n)}function a(t,e,n){this.type="null",s.call(this,t,e,n)}function l(t,s,o){if(this.constructor===l)throw new Error("This is abstract class");var r,i,a,c=this,u=document.createElement("li"),d=[];c.label=t,c.isComplex=!0,u.classList.add("jsontree_node"),u.classList.add("jsontree_node_complex"),u.innerHTML=function(t,e){var n=o?"":",",s='                        <div class="jsontree_value-wrapper">                            <div class="jsontree_value jsontree_value_'+c.type+'">                                <b>'+e[0]+'</b>                                <span class="jsontree_show-more">&hellip;</span>                                <ul class="jsontree_child-nodes"></ul>                                <b>'+e[1]+"</b></div>"+n+"</div>";return null!==t&&(s='                        <span class="jsontree_label-wrapper">                            <span class="jsontree_label"><span class="jsontree_expand-button"></span>"'+t+'"</span> : \t\t\t\t\t</span>'+s),s}(t,c.sym),r=u.querySelector(".jsontree_child-nodes"),null!==t?(i=u.querySelector(".jsontree_label"),a=u.querySelector(".jsontree_show-more"),i.addEventListener("click",(function(t){if(!t.altKey)return t.shiftKey?(document.getSelection().removeAllRanges(),void alert(c.getJSONPath())):void c.toggle(t.ctrlKey||t.metaKey);c.toggleMarked()}),!1),a.addEventListener("click",(function(t){c.toggle(t.ctrlKey||t.metaKey)}),!1),c.isRoot=!1):(c.isRoot=!0,c.parent=null,u.classList.add("jsontree_node_expanded")),c.el=u,c.childNodes=d,c.childNodesUl=r,e.forEachNode(s,(function(t,e,s){c.addChild(new n(t,e,s))})),c.isEmpty=!Boolean(d.length),c.isEmpty&&u.classList.add("jsontree_node_empty")}function c(t,e,n){this.sym=["{","}"],this.type="object",l.call(this,t,e,n)}function u(t,e,n){this.sym=["[","]"],this.type="array",l.call(this,t,e,n)}function d(t,e){this.wrapper=document.createElement("ul"),this.wrapper.className="jsontree_tree clearfix",this.rootNode=null,this.sourceJSONObj=t,this.loadData(t),this.appendTo(e)}return n.CONSTRUCTORS={boolean:o,number:r,string:i,null:a,object:c,array:u},s.prototype={constructor:s,mark:function(){this.el.classList.add("jsontree_node_marked")},unmark:function(){this.el.classList.remove("jsontree_node_marked")},toggleMarked:function(){this.el.classList.toggle("jsontree_node_marked")},expandParent:function(t){this.parent&&(this.parent.expand(),this.parent.expandParent(t))},getJSONPath:function(t){return this.isRoot?"$":(e="array"===this.parent.type?"["+this.label+"]":t?"."+this.label:"['"+this.label+"']",this.parent.getJSONPath(t)+e);var e}},e.inherits(o,s),e.inherits(r,s),e.inherits(i,s),e.inherits(a,s),e.inherits(l,s),e.extend(l.prototype,{constructor:l,addChild:function(t){this.childNodes.push(t),this.childNodesUl.appendChild(t.el),t.parent=this},expand:function(t){this.isEmpty||(this.isRoot||this.el.classList.add("jsontree_node_expanded"),t&&this.childNodes.forEach((function(e,n){e.isComplex&&e.expand(t)})))},collapse:function(t){this.isEmpty||(this.isRoot||this.el.classList.remove("jsontree_node_expanded"),t&&this.childNodes.forEach((function(e,n){e.isComplex&&e.collapse(t)})))},toggle:function(t){if(!this.isEmpty&&(this.el.classList.toggle("jsontree_node_expanded"),t)){var e=this.el.classList.contains("jsontree_node_expanded");this.childNodes.forEach((function(n,s){n.isComplex&&n[e?"expand":"collapse"](t)}))}},findChildren:function(t,e,n){this.isEmpty||this.childNodes.forEach((function(s,o){t(s)&&e(s),s.isComplex&&n&&s.findChildren(t,e,n)}))}}),e.inherits(c,l),e.inherits(u,l),d.prototype={constructor:d,loadData:function(t){e.isValidRoot(t)?(this.sourceJSONObj=t,this.rootNode=new n(null,t,"last"),this.wrapper.innerHTML="",this.wrapper.appendChild(this.rootNode.el)):alert("The root should be an object or an array")},appendTo:function(t){t.appendChild(this.wrapper)},expand:function(t){this.rootNode.isComplex&&("function"==typeof t?this.rootNode.childNodes.forEach((function(e,n){e.isComplex&&t(e)&&e.expand()})):this.rootNode.expand("recursive"))},collapse:function(){"function"==typeof this.rootNode.collapse&&this.rootNode.collapse("recursive")},toSourceJSON:function(t){if(!t)return JSON.stringify(this.sourceJSONObj);var e="[%^$#$%^%]",n=JSON.stringify(this.sourceJSONObj,null,e);return n=(n=n.split("\n").join("<br />")).split(e).join("&nbsp;&nbsp;&nbsp;&nbsp;")},findAndHandle:function(t,e){this.rootNode.findChildren(t,e,"isRecursive")},unmarkAll:function(){this.rootNode.findChildren((function(t){return!0}),(function(t){t.unmark()}),"isRecursive")}},{create:function(t,e){return new d(t,e)}}}();var r=n(669),i=function(){return i=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};const a=function(){function t(t){void 0===t&&(t=null);var e=this;this.addAtumClasses(t),r("body").on("wc-enhanced-select-init",(function(){return e.addAtumClasses(t)}))}return t.prototype.maybeRestoreEnhancedSelect=function(){r(".select2-container--open").remove(),r("body").trigger("wc-enhanced-select-init")},t.prototype.doSelect2=function(t,e,n){var s=this;void 0===e&&(e={}),void 0===n&&(n=!1),"function"==typeof r.fn.select2&&(e=Object.assign({minimumResultsForSearch:10},e),t.each((function(t,o){var a=r(o),l=i({},e);a.hasClass("atum-select-multiple")&&!1===a.prop("multiple")&&a.prop("multiple",!0),a.hasClass("atum-select2")||(a.addClass("atum-select2"),s.addAtumClasses(a)),n&&a.on("select2:selecting",(function(t){var e=r(t.currentTarget),n=e.val();Array.isArray(n)&&(r.inArray("",n)>-1||r.inArray("-1",n)>-1)&&(r.each(n,(function(t,e){""!==e&&"-1"!==e||n.splice(t,1)})),e.val(n))})),a.select2(l),a.siblings(".select2-container").addClass("atum-select2"),s.maybeAddTooltip(a)})))},t.prototype.addAtumClasses=function(t){var e=this;void 0===t&&(t=null),(t=t||r("select").filter(".atum-select2, .atum-enhanced-select")).length&&t.each((function(t,n){var s=r(n),o=s.siblings(".select2-container").not(".atum-select2, .atum-enhanced-select");o.length&&(o.addClass(s.hasClass("atum-select2")?"atum-select2":"atum-enhanced-select"),e.maybeAddTooltip(s))})).on("select2:opening",(function(t){var e=r(t.currentTarget).data();if(e.hasOwnProperty("select2")){var n=e.select2.dropdown.$dropdown;n.length&&n.addClass("atum-select2-dropdown")}}))},t.prototype.maybeAddTooltip=function(t){t.hasClass("atum-tooltip")&&t.siblings(".select2-container").find(".select2-selection__rendered").addClass("atum-tooltip")},t}();var l=n(669);const c=function(){function t(t,e){this.settings=t,this.enhancedSelect=e,this.steps=["all","source","module"],this.$selectWrapper=l(".log-filters .actions-wrapper"),this.currentSource="all",this.currentModule="all",this.stepsData=this.settings.get("sourceMap"),this.buildSelectFilter()}return t.prototype.buildSelectFilter=function(){l("#atum-step-filter").length<=0&&this.initializeSelectFilter(),this.$selectFilter=l("#atum-step-filter"),this.bindFilterAction(),this.enhancedSelect.doSelect2(this.$selectFilter)},t.prototype.initializeSelectFilter=function(){var t=l("<select>");t.attr({id:"atum-step-filter",name:"step_filter",class:"wc-enhanced-select atum-enhanced-select dropdown_log_source auto-filter"}),this.writeOption(t,"all",this.settings.get("showAll"),"all"),this.$selectWrapper.append(t)},t.prototype.writeOption=function(t,e,n,s){var o;(o=l("<option>")).val(e).html(n).data("type",s),("source"===s&&e===this.currentSource||"module"===s&&e===this.currentModule)&&o.attr("selected","selected"),t.append(o)},t.prototype.loadOptions=function(){var t;this.$selectFilter.html("");for(var e=0,n=this.steps;e<n.length;e++){var s=n[e];if("all"===s)this.writeOption(this.$selectFilter,s,this.settings.get("showAll"),"all");else if("source"===s)for(var o in this.stepsData)this.writeOption(this.$selectFilter,this.stepsData[o].slug,this.stepsData[o].name,s),this.stepsData[o].slug===this.currentSource&&(t=o);else for(var r=0,i=this.stepsData[t].modules;r<i.length;r++){var a=i[r];this.writeOption(this.$selectFilter,a.slug,this.stepsData[t].name+": "+a.name,s)}if("all"===this.currentSource&&"source"===s)break}},t.prototype.bindFilterAction=function(){var t=this;this.$selectFilter.on("select2:select",(function(e){var n=t.$selectFilter.children("option:selected").data("type"),s=t.$selectFilter.val();"source"===n?(t.currentSource=s,t.currentModule="all"):"module"===n?t.currentModule=n:(t.currentSource="all",t.currentModule="all")}))},t}(),u=Swal;var d=n.n(u),p=n(669);const h=function(){function t(t){this.settings=t,this.forceEdit=!1,this.counter=parseInt(p("#logs-unread-badge").text().trim()),this.wpHooks=window.wp.hooks,this.filter=new c(this.settings,new a),setTimeout(this.addSearchBySKU,300),this.bindEvents(),this.addHooks()}return t.prototype.addSearchBySKU=function(){var t=p('<a class="dropdown-item" href="#" />'),e=p('.atum-list-wrapper[data-list="log-registry"]'),n=e.find(".search-column-dropdown");e.find(".search-column-btn");n.append(t.clone().data("value","sku").text("SKU")),console.log("helloWorld")},t.prototype.bindEvents=function(){var t=this;p("body").on("click","table.atum-list-table.log-registry #the-list .column-entry a",(function(t){return window.open(p(t.currentTarget).attr("href"),"_blank"),!1})).on("click",".delete-all-trash-logs",(function(){confirm(t.settings.get("confirmEmptyTrash"))&&t.singleAction("empty_trash",0)})).on("atum-list-table-bulk-actions-success",(function(e,n,s){var o="",r=0;switch(n){case"mark_read":case"delete_logs":o="decrease";break;case"unmark_read":o="increase";break;default:return}for(var i=0;i<s.length;i++){var a=p("tr[data-id="+s[i]+"]").hasClass("log_unread");("decrease"===o&&a||"increase"===o&&!a)&&r++}t.updateUnreadBadge(o,r)})),p("#logs-unread-badge").on("click",(function(t){return p("#log_registry_nav").find("#unread").trigger("click")}))},t.prototype.addHooks=function(){var t=this;this.wpHooks.addAction("atum_listTable_tableUpdated","atum",(function(){return t.filter.buildSelectFilter()})),this.wpHooks.addAction("atum_menuPopover_clicked","atum",(function(e,n){var s=p(e.currentTarget).data("name");"function"==typeof t[s]&&t[s](n.closest("tr").data("id"))}))},t.prototype.deleteLog=function(t){this.singleAction("delete_logs",t)},t.prototype.deletePermanently=function(t){this.singleAction("erase_logs",t)},t.prototype.restoreLog=function(t){this.singleAction("undelete_logs",t)},t.prototype.markFeatured=function(t){this.singleAction("mark_featured",t)},t.prototype.unmarkFeatured=function(t){this.singleAction("unmark_featured",t)},t.prototype.markRead=function(t){this.singleAction("mark_read",t)},t.prototype.markUnread=function(t){this.singleAction("unmark_read",t)},t.prototype.viewData=function(t){this.showLogDataPopup(t)},t.prototype.updateUnreadBadge=function(t,e){if("increase"===t)this.counter+=e;else{if("decrease"!==t)return;this.counter-=e}p("#logs-unread-badge").html(this.counter.toString())},t.prototype.prepareSingleAction=function(t){var e=t.data("action"),n=t.data("id");this.singleAction(e,n)},t.prototype.singleAction=function(t,e){var n=this,s="Array"===window.atum.ListTable.constructor.name?window.atum.ListTable[0]:window.atum.ListTable;p.ajax({url:window.ajaxurl,method:"POST",dataType:"json",data:{action:"atum_apply_bulk_action",security:this.settings.get("logDataNonce"),bulk_action:t,ids:[e]},beforeSend:function(){return s.addOverlay()},success:function(e){if(e.success){s.updateTable();var o="";switch(t){case"mark_read":case"delete_logs":o="decrease";break;case"unmark_read":o="increase";break;default:return}n.updateUnreadBadge(o,1)}},error:function(){return s.removeOverlay()}})},t.prototype.showLogDataPopup=function(t){var e=this;d().fire({title:this.settings.get("logDataTitle"),html:'<div id="tree" class="atum-tree"></div>',showCancelButton:!1,showConfirmButton:!1,showCloseButton:!0,background:"var(--atum-table-bg)",didOpen:function(){var n=p("#tree");p.ajax({url:window.ajaxurl,method:"post",data:{action:"atum_display_log_data",security:e.settings.get("logDataNonce"),id:t},beforeSend:function(){return n.append('<div class="atum-loading" />')},success:function(t){p(".atum-loading").remove(),e.displayJsonTree(JSON.parse(t),n)}})}})},t.prototype.displayJsonTree=function(t,e){o.create({},e.get(0)).loadData(t)},t}();n(669)((function(t){var e=new s("atumLogRegistry");new h(e)}))})();